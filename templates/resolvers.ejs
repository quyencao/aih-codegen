const db = require('./db');

const resolver = {
    Query: {
        <%_ types.forEach(function(type){ _%>
        get<%= type["name"] %>: (_, args) => {
            return db.getTable("<%= type["ref"] %>").getRecordById(args.id).then(data => {
                return data.Item
            }).catch(err => null);
        },
        get<%= type["name"] %>s: (_, args) => {
            return  db.getTable("<%= type["ref"] %>").getRecords({}).then(data => {
                return data.Items
            }).catch(err => null);
        },
        <%_ }); _%>
    },
    Mutation: {
        <%_ types.forEach(function(type){ _%>
        create<%= type["name"] %>: (_, args) => {
            return db.getTable("<%= type["ref"] %>")
            .insertRecord(args.input)
            .then(data => data)
            .catch(err => {
                throw err;
            })
        },
        delete<%= type["name"] %>: (_, args) => {
            return db.getTable("<%= type["ref"] %>")
                .deleteRecordById(args.id)
                .then(data => true)
                .catch(err => false);
        },
        update<%= type["name"] %>: (_, args) => {
            return db.getTable("<%= type["ref"] %>")
                .updateRecordById(args.id, args.input)
                .then(data => data.Attributes)
                .catch(err => null);
        },
        <%_ }); _%>
    }
}

module.exports = resolver;